<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>DonKats Pay Now</title>

  <!-- âœ… PayPal Live Script (Replace with your LIVE client ID if needed) -->
  <script src="https://www.paypal.com/sdk/js?client-id=BAArRR1mKa6xQaV43Xt-gr0Xy9WQ_6KvjBj8gAGI7VQ6QlPwESVK1luyBSEFptRCZMTmeLbhzlOWH-mV0M&currency=USD&disable-funding=paylater"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 60px auto;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 10px;
      background-color: #f7f7f7;
    }

    h2 {
      color: #2e8b57;
    }

    #paypal-button-container {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h2>DonKats Meal Planner</h2>
  <p><strong>One-time payment: $6.95</strong></p>

  <div id="paypal-button-container"></div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      console.log("DOM ready, initializing PayPal button...");

      paypal.Buttons({
        createOrder: function(data, actions) {
          console.log("Creating order...");
          return actions.order.create({
            purchase_units: [{
              amount: { value: '6.95' }
            }]
          });
        },
        onApprove: function(data, actions) {
          console.log("Payment approved. Capturing...");
          return actions.order.capture().then(function(details) {
            console.log("Payment captured. Sending confirmation...");
            fetch('/confirm', { method: 'POST' })
              .then(() => {
                console.log("Redirecting to /form");
                window.location.href = "/form";
              });
          });
        },
        onError: function(err) {
          console.error("PayPal Button Error:", err);
          alert("An error occurred with PayPal: " + err.message);
        }
      }).render('#paypal-button-container');
    });
  </script>
</body>
</html>
